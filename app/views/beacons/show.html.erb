<p id="notice"><%= notice %></p>
<h2>Beacon</h2>
<ul>
  <li><b>Installation:</b> <%= @installation.name %></li>
  <li><b>State:</b> <%= current_state(@beacon).capitalize %></li>
  <li><b>Location:</b> <%= @beacon.location %></li>
</ul>
<div class="beacon-page-column-wrap">
  <% if !(@beacon.latitude.nil? || @beacon.longitude.nil?) %>
    <div class="map-wrap">
      <div id="beacon-map"></div>
    </div>
    <ul>
      <li><b>Latitude:</b> <%= cardinalized_latitude(@beacon) %></li>
      <li><b>Longitude:</b> <%= cardinalized_longitude(@beacon) %></li>
    </ul>
  <% else %>
    <%= image_tag "map-missing.png" %>
    <p>This beacon currently does not have any attached coordinates.</p>
  <% end %>
</div>
<div class="beacon-page-column-wrap">
  <%= image_tag @beacon.content_image.url(:medium) %>
  <h3>Beacon Info</h3>
  <ul>
    <li><b>Minor ID:</b> <%= display_id(@beacon.minor_id) %></li>
    <li><b>Major ID:</b> <%= display_id(@beacon.major_id) %></li>
    <li><b>UUID:</b> <%= @beacon.uuid %></li>
  </ul>
  <h3>Content Info</h3>
  <ul>
    <li><b>Content:</b> <%= @beacon.content_file_name ? @beacon.content_file_name : "No content." %></li>
    <li><b>Content Type:</b> <%= @beacon.content_content_type ? @beacon.content_content_type : "No content." %></li>
    <li><b>Audio:</b> <%= @beacon.audio_file_name ? @beacon_audio.file_name : "No audio file." %></li>
  </ul>
</div>
<div id="beacon-show-page-link-wrapper">
<%= link_to "Edit Beacon", edit_beacon_path(@beacon) %><br>
<%= link_to "Back to #{@installation.name.capitalize} Installation", installation_path(@installation) %>
</div>

<script type="text/javascript">
  handler = Gmaps.build('Google');
  handler.buildMap({ provider: {}, internal: {id: 'beacon-map'}}, function(){
    markers = handler.addMarkers(<%=raw @hash.to_json %>);
    handler.bounds.extendWith(markers);
    handler.fitMapToBounds();
  });
</script>
